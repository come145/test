<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">


<select id="listAll" resultType="com.study.vo.BoardVO">

select num,subject,writer,created,hitcount from cha_board 

<include refid="search"></include>
order by num desc,created desc

</select>

<insert id="insert">

insert into cha_board(

num, writer,email,content,pwd,created, subject)

values(#{num},#{writer}, #{email}, #{content}, #{pwd},now(), #{subject})

</insert>


<select id="read" resultType="com.study.vo.BoardVO">

select  num,
subject,
content,
writer,
created,
hitcount,
email
from cha_board
where num = #{num}



</select>


<!-- 게시물 조회수 증가 -->
<update id="increaseViewcnt">
	
	update cha_board set hitcount = hitcount + 1
	where num = #{num}

</update>


<update id="update">

update cha_board set

subject = #{subject},
writer = #{writer},
email = #{email},
content = #{content},
pwd = #{pwd}

where num = #{num}

</update>

<delete id="delete">

delete from cha_board where num = #{num}

</delete>

<select id="countArticle" resultType="int">

select count(*) from cha_board

	<include refid="search"></include>
</select>

 <!-- 검색옵션 쿼리 -->
 <sql id="search">
        <choose>
          
           <when test="searchOption == 'all'">
                where  		
 				writer LIKE CONCAT('%', #{keyword}, '%')
                OR content LIKE CONCAT('%', #{keyword}, '%')
                OR subject LIKE CONCAT('%', #{keyword}, '%')
                </when>
                
                
            <otherwise>
               
                where ${searchOption} like CONCAT('%', #{keyword}, '%')
            </otherwise>
        </choose>
</sql>



</mapper>